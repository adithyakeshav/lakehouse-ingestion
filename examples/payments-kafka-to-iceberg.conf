# Example: Payments transactions from Kafka to Iceberg (Bronze Layer)
#
# This example demonstrates:
# - Reading from Kafka streaming source
# - Using schema registry for explicit schema
# - Writing to Iceberg lakehouse format
# - Basic data quality checks
# - Bronze layer ingestion pattern

env = "dev"

jobs = [
  {
    domain = "payments"
    dataset = "transactions"

    source = {
      type = "kafka"
      options = {
        bootstrap.servers = "localhost:9092"
        subscribe = "payments.transactions"
        startingOffsets = "latest"
        streaming = "true"
        # Kafka consumer settings
        kafka.security.protocol = "PLAINTEXT"
        failOnDataLoss = "false"
      }
    }

    target = {
      table = "payments.transactions_bronze"
      lakehouse_format = "iceberg"
      catalog = "hive"
      layer = "bronze"
      partitions = ["event_date"]
    }

    schema = {
      registry_domain = "payments"
      registry_dataset = "transactions"
      version = "v1"  # Or omit for latest version
    }

    data_quality = {
      ruleset = "payments.transactions.bronze"
      on_fail = "LOG_ONLY"  # Options: FAIL_FAST, QUARANTINE, LOG_ONLY
    }
  }
]
