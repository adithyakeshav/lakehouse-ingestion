env = "dev"

jobs = [
  {
    domain  = "music_school"
    dataset = "music_school_cdc_bronze"

    source {
      type = "kafka"
      options {
        kafka.bootstrap.servers = "datalake-kafka-cluster-kafka-bootstrap.kafka.svc.cluster.local:9092"
        subscribe              = "postgres_cdc_music_school_db"
        startingOffsets        = "earliest"
        streaming              = "true"
        # Optional:
        # endingOffsets        = "latest"
        # security.protocol    = "SASL_SSL"
        # sasl.mechanism       = "PLAIN"
        # sasl.jaas.config     = "..."
      }
    }

    target {
      # Fully-qualified Iceberg table identifier (must be created ahead of time)
      checkpointLocation     = "s3a://learn-spark/checkpoints/music_school_cdc_bronze"
      table                  = "iceberg.bronze.music_school_cdc"
      lakehouse_format       = "iceberg"
      catalog                = "hive"
      layer                  = "bronze"
      # For metadata only; actual partitioning is defined in the Iceberg table DDL
      partitions       = [ "cdc_record_ts" ]
    }

    schema {
      registry_domain  = "music_school"
      registry_dataset = "music_school_cdc"
      # optional: version = "v1"
    }

    data_quality {
      # No rules yet; just log if/when we add them
      on_fail = "LOG_ONLY"
    }
  }
]